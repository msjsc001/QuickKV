# ⌨️ QuickKV （Q-KV）轻量级中文自动补全拓展软件
<img width="1916" height="993" alt="PixPin_2025-07-28_13-36-22" src="https://github.com/user-attachments/assets/7f852744-81a3-4f0f-a050-7a5bb702c76c" />

<p align="center">
  <a href="https://github.com/msjsc001/QuickKV/releases/latest"><img src="https://img.shields.io/github/v/release/msjsc001/QuickKV"></a>
  <a href="https://github.com/msjsc001/QuickKV/commits/master"><img src="https://img.shields.io/github/last-commit/msjsc001/QuickKV"></a>
  <a href="https://github.com/msjsc001/QuickKV/releases"><img src="https://img.shields.io/github/downloads/msjsc001/QuickKV/total?label=Downloads&color=brightgreen"></a>
</p>

**QuickKV是一款只专注于中文自动补全、文本拓展的开源、轻量级、高效、零门槛、易迁移、轻度剪贴板记忆、高可定制化、纯净无任何商业目的快捷输入增强工具**。它能让您将所有常用的文本片段（如邮箱、代码、模板、常用回复等）保存在一个或多个简单的 Markdown 文件词库中（多词库可灵活勾选使用），通过全局热键 `Ctrl+Space` 在任何应用程序中即时搜索并粘贴它们（支持拼音首字母，空格多词），极大地提升您的输入效率。
- 它与**自动补全类软件旗舰软件** FastKeys、PhraseExpander 不同的是，KV只专注于中文补全且支持中文超轻量级，没有其它更多的功能,比如输入字母后加一个特定按钮打开一个软件、网站之类，如果有需要这类功能**推荐可以 FastKeys 配合使用，KV这里就不重复造轮子了**，FastKeys也是款很不错的软件。PhraseExpander 是自动补全标杆级软件，功能相对繁杂，喜欢的也可以尝试。（不过就我个人而言，并不是太乐意去记忆几个字母+一个特定按钮激活的方式来打开软件，因为我自己有几百个软件这样根本不现实，也徒增认知负担，更喜欢图形化直观的图标，我个人更的是用OneCommander，做一个快捷启动的文件夹，文件夹里有分类一键就能展开各种复杂分类打开程序，非常稳定高效，几乎无迁移问题）
- 它与**剪贴板旗舰类软件** Ditto 的差异是更便捷，**KV也轻度的支持剪贴板记忆**，Ditto 也能将文本图片等分组固定，后期通过快捷搜索找到内容贴入，不过你可能要多按几次键盘按钮，**它更多是侧重在功能强大的剪贴板管理**，而非补全，有很多细微的差异。总的来说它也是一种不错的方式，推荐喜欢的朋友也可以试试，也可以组合使用，由于它的剪贴板功能更强大，**你也可以选择关闭KV的剪贴板记忆使用它的剪贴板，使用KV的补全输入**，这样两者的长处都取，总之选择自己最喜欢的方式（我个人更用KV的简单方式的剪贴板已经足够）。
- 它与**通常输入法自定义短语**非常类同，的差异是搜索、展现、管理逻辑不一样。输入法的更多是**联想查找**，而KV是**匹配查找**，搜索上KV是聚焦不是发散。展现上KV是任意调节窗口的列表列表式，更利于对比。管理上多md词库（这和txt文本就只是后缀不同），非常易于管理和迁移。不过如果你只有很少的词需要进行拓展，其实输入法自带的短语也就够用了，无须用到KV这些软件，没有需求就不用创造需求，凭空增加自己使用电脑的的成本，但如果你有文本拓展需求时使用KV或上述提到的软件，那就是效率增益。
- 它与**脚本语言自动化软件自动补全软件 AutoHotkey、Espanso 差异是**，它是定制好的，是基于 Python 的， Python 延展性可库支持是很强大的，且现在AI编程对Python的支持是非常好的，很多简单的需求和改进一句话基本就能解决需求，换句话说对小白而言只要环境搭建好开发效率也会大大高于 Quicker 这类积木软件，你都不用去搭积木了。
- 它与**工具库插件库类软件 Flow Launcher、Quicker**这类庞大快的指令型软件差异，也是很明显的，你不需要去写一个插件，它已经是一个完成体，当然你要喜欢自己用代码或搭积木再定制，那么上这两也是可以的。

**Anyhow 按自己所需所喜欢的来就是最适合，就是最好的！**

---

## 📢 最新更新与变更历史

项目的详细**更新日志与变更历史**请移至单独的 [文档 (CHANGELOG.md)](CHANGELOG.md) 进行查阅。

---

## 简易图文教程
![20210606180518](https://github.com/user-attachments/assets/3fc1af9b-9ce7-448e-b68a-695b3bb743d4)
<img alt="PixPin_2025-07-28_14-01-50" src="https://github.com/user-attachments/assets/cdb09453-9761-4790-87f0-325a2f4bd80b" />
<img alt="PixPin_2025-07-28_14-12-41" src="https://github.com/user-attachments/assets/33ecb4d8-fe0f-4dc9-90f0-e0ee6702c9ed" />
<img alt="PixPin_2025-08-05_18-37-04" src="https://github.com/user-attachments/assets/df7e170b-6fc1-40fa-8812-86be66481ec1" />

<img alt="PixPin_2025-08-02_00-11-00" src="https://github.com/user-attachments/assets/a10595ac-bada-4a4b-93f6-39bef4bf405a" />
<img alt="PixPin_2025-07-28_14-20-04" src="https://github.com/user-attachments/assets/be0a526a-8dc2-4179-8935-7caf4e70a3b1" />
<img alt="PixPin_2025-07-28_14-23-06" src="https://github.com/user-attachments/assets/000ccf0e-5585-4880-97d6-243dbd70a293" />
<img alt="PixPin_2025-07-28_14-36-52" src="https://github.com/user-attachments/assets/2fafcfe6-15ff-40ff-9d92-c5a0b8502e62" />
<img alt="PixPin_2025-07-28_15-00-50" src="https://github.com/user-attachments/assets/dd679348-6b82-4364-96f1-ed6e9eee84e7" />
<img alt="PixPin_2025-07-28_15-08-24" src="https://github.com/user-attachments/assets/b48a1555-347c-4bf3-ae89-2852c599ed0e" />
<img alt="PixPin_2025-07-28_15-31-43" src="https://github.com/user-attachments/assets/061fdf73-98a2-47d1-93f5-c9453cbda5bd" />
<img alt="PixPin_2025-07-28_15-21-46" src="https://github.com/user-attachments/assets/909f6cfa-6b51-416c-8dde-4bd326b227f8" />

---

## QuickKV核心特性（文本介绍）

*   **全局热键**: 在任何地方按下 `Ctrl + Space` 即可呼出搜索框。
*   **多词库管理**:
    *   支持同时加载多个 `.md` 词库文件。
    *   可在托盘菜单中动态添加、启用/禁用、移除词库。
    *   可快速打开词库文件所在的目录，方便编辑。
*   **剪贴板记忆**:
    *   可选功能，开启后可自动记录剪贴板的文本内容。
    *   在搜索框为空时优先显示剪贴板历史，方便快速粘贴。
    *   支持自定义记忆数量和一键清空历史。
*   **词条管理**:
    *   支持在程序内通过右键菜单直接**添加、编辑、删除**词条。
    *   支持多行词条（父子内容），用于管理复杂的模板和代码片段。
    *   独有的 ` ``不出现`` ` 语法，可在粘贴时忽略父级标题。
    *   **快捷码** ` ``k:xxx`` ` 语法，通过输入 `xxx` 直接触发粘贴，实现零点击操作。
*   **智能搜索**:
    *   支持对父级词条进行关键词模糊搜索和多关键词筛选（空格分隔）。
    *   支持**拼音首字母搜索**，输入 `qd` 即可匹配“请定”。
*   **高度自定义**:
    *   支持**日间/夜间**双主题。
    *   可自由**调整窗口大小**和**设置字体大小**。
    *   支持**窗口置顶**（图钉功能）。
*   **稳定性保障**:
    *   **原生快捷键**: 使用 Windows 原生 API 注册全局热键，彻底告别因钩子不稳定导致的快捷键失效问题。
    *   可选的**间隔时间自动重启**功能，确保程序长时间稳定运行。
*   **轻量与高效**: 后台静默运行，占用极少系统资源，并通过文件热重载实现配置和词库的实时更新。


---

## 用户手册

### 1. 安装与配置

**步骤一：安装依赖**

如果使用exe程序在 https://github.com/msjsc001/QuickKV/releases 下载即可，无须使用 Python 配置，可跳过步骤一二三，exe程序会被杀软误杀加入白名单就能正常运行。

本工具使用 Python 编写，需要您先安装 Python 环境（推荐 Python 3.8+）。然后，在终端中运行以下命令安装所需库：

```bash
pip install PySide6 pyperclip pypinyin
```

**步骤二：准备文件**

1.  将代码保存为 `quick_kv.py`。
2.  在 `quick_kv.py` 所在的目录下，创建一个名为 `词库.md` 的文件。如果文件不存在，程序首次启动时会自动为您创建示例。

**步骤三：编辑词库**

用任何文本编辑器打开 `.md` 词库文件。程序支持两种格式的词条：

**1. 单行词条**
每一行以 `- ` (减号 + 空格) 开头即可。
```markdown
- 我的个人邮箱是 my-email@example.com
- 公司地址：XX省XX市XX区XX路XX号
```

**2. 多行词条 (父子内容)**
以 `- ` 开头的行作为“父级”（用于搜索），其下方所有不以 `- ` 开头的行都会被视为“子内容”。

```markdown
- 这是一个父级
这是它的子内容第一行
  这也是子内容（支持缩进和空行）

- 这是一个模板标题 ``不出现``
  这是模板的第一行内容
  这是模板的第二行内容
```

*   **` ``不出现`` ` 语法**: 如果您希望在粘贴时只输出子内容，而忽略父级（例如模板的标题），只需在父级行末尾加上 ` ``不出现`` ` 即可。

**3. 快捷码 (高级功能)**
快捷码是一种无需呼出搜索框即可快速粘贴内容的方式。

*   **设置快捷码**: 在词条的父级行末尾，添加 ` ``k:触发码`` ` 语法。触发码可以是任何字母、数字或符号的组合。
    ```markdown
    - 我的个人邮箱 ``k:mymail``
    - 项目路径 ``k:p1;``
    ```
*   **使用快捷码**:
    1.  在系统托盘菜单中，勾选“开启快捷码”。
    2.  在任何文本编辑器中，直接输入您设置的触发码（例如 `mymail` 或 `p1;`）。
    3.  程序会自动删除您输入的触发码，并将其替换为对应的词条内容。

### 2. 使用说明

1.  **启动程序**:

    在终端中，进入 `quick_kv.py` 文件所在的目录，然后运行：
    ```bash
    python quick_kv.py
    ```

2.  **呼出窗口**:
    在任何需要输入文本的地方，按下快捷键 `Ctrl + Space`。

3.  **搜索与选择**:
    *   在搜索框中输入关键词进行搜索。
    *   使用 `上/下` 方向键或鼠标选择结果。
    *   按下 `回车` 键或用鼠标**单击**词条完成选择。

4.  **管理程序**:
    在系统托盘区找到程序图标，**右键点击**可进行所有高级操作，包括：
    *   **启用/禁用快捷键**: 总开关。
    *   **间隔时间自动重启**: 设置程序自动重启以保持稳定。
    *   **词库选择**: 管理你的多个词库文件。
    *   **搜索选项**: 切换“多词搜索”和“拼音首字母匹配”。
    *   **剪贴板记忆**: 开启或关闭剪贴板历史功能。
    *   **UI设置**: 切换主题、调整字体大小。
    *   **退出**: 关闭程序。
  
## ⚒️ QuickKV 词库加强辅助 KVTree

KVTree 支持用 Markdown 文件无序列表树（大纲）建立词库，建立的词库软件会自动转换生成为 QuickKV 词库
需要可点击下载使用 → [KVTree](https://github.com/msjsc001/KV-Tree/)

V1.2.0版界面
<img width="2120" height="1586" alt="image" src="https://github.com/user-attachments/assets/4e8406e2-150c-4018-b877-331808b28e5a" />
V0.5-0.9版图解演示
<img alt="503D67DE29FDBA7D13832F52DB4007DF" src="https://github.com/user-attachments/assets/78b83c0a-4307-4ed9-9e21-d119b2f80e7d" />
<img alt="image" src="https://github.com/user-attachments/assets/82fb7bec-96e3-4114-95b5-a813ff73f2e9" />
---

## 开发者指南

### 1. 项目架构 (v1.2 MVC 分解版本)

为了实现高解耦度与提升未来的维护性和 AI 辅助开发效率，QuickKV v1.2 将原本单文件的逻辑进行了彻底的物理隔离，拆分为以下核心模块：

*   **`core/` (核心配置与数据层)**: 存放了不包含UI组件的纯逻辑代码，包含配置加载 `config.py`，参数管理 `settings.py`，以及全盘词库聚合和搜索映射逻辑的 `word_manager.py` 和 `word_source.py`。
*   **`ui/` (表现层)**: 存放所有基于 PySide6 构建的图形界面组件，如主要的搜索无边框窗口 `search_popup.py`，负责渲染多行变色排版的 `delegates.py`，以及其余弹框 `components.py`。
*   **`services/` (系统服务层)**: 集成了所有后台监听进程，负责与操作系统的外部交互。包括 Windows 原生快捷键调用 `hotkey_manager.py` 和基于 pynput 捕获快捷码的 `shortcut_listener.py`。
*   **`main_controller.py`**: 作为项目的主要调度员，不包含具体底层逻辑，只负责拼接各个组件并连接信号。

### 2. 核心技术点

*   **原生快捷键与线程安全**: 使用 `ctypes` 调用 Windows 原生 API (`RegisterHotKey`) 在一个独立的 `threading` 线程中监听全局热键。当热键被触发时，通过 PySide6 的**信号/槽机制**安全地通知主GUI线程执行相应操作，做到了响应迅速且线程安全。
*   **文件监控与防抖**: 使用 `QFileSystemWatcher` 监控文件变化，并结合 `QTimer` 实现“防抖”，避免文件在短时间内被多次保存时触发重复的重载操作。
*   **无边框窗口交互**: 通过重写 `mousePress/Move/ReleaseEvent` 事件实现窗口拖拽，并通过判断鼠标位置和 `_update_resize_cursor` 方法动态改变光标，实现各方向的窗口缩放。

### 3. 项目结构

```
.
├── src/                    # 项目源代码总目录
│   ├── main.py             # 极简入口启动脚本
│   ├── main_controller.py  # 核心总控与信号调度中枢
│   ├── core/               # 核心层
│   │   ├── config.py       # 常量及全局路径定义
│   │   ├── settings.py     # config.ini读写与配置状态
│   │   ├── word_source.py  # 单词库文件解析器
│   │   └── word_manager.py # 全量词库管理、搜索与缓存策略
│   ├── services/           # 后台系统交互服务
│   │   ├── hotkey_manager.py     # 系统原生全局热键服务 (比如 Ctrl+Space)
│   │   └── shortcut_listener.py  # 键盘快捷码输入监听服务
│   ├── ui/                 # 图形界面层
│   │   ├── components.py   # 可复用组件、各类对话框
│   │   ├── delegates.py    # 词条列表定制渲染器 (包括基于规则的高亮逻辑)
│   │   └── search_popup.py # 无边框搜索主窗口逻辑与交互
│   └── utils/              # 通用工具函数模块
│       └── paths.py        # 相对/绝对路径定位处理
├── README.md               # 项目介绍说明文档 (当前文档)
├── CHANGELOG.md            # 项目版本变更历史与更新日志
└── quick_kv.py.bak         # v1.1版本的冗余单文件备份 (可删除)
```
> **注**：运行或打包程序所需的诸如 `icon.png`, `config.ini`, `.md`词库, `.json`缓存等配置文件，均会在 `src/` 目录下由程序动态生成并在该级作用域内读取。

### 4. 构建可执行文件 (Windows)

本项目使用 PyInstaller 进行打包。

1.  **安装 PyInstaller**:
    ```bash
    pip install pyinstaller
    ```

2.  **执行打包命令**:
    在项目根目录下，使用安装好的 Python 环境运行以下命令来创建一个独立的 `.exe` 文件：
    ```bash
    pyinstaller --noconsole --icon="src/icon.png" --add-data "src/icon.png;." --name "QuickKV" src/main.py
    ```
    *   `--noconsole`: 运行时不显示命令行窗口。
    *   `--icon`: 为 `.exe` 文件和系统托盘指定图标。
    *   `--add-data`: 将图标资源一并打包。`词库.md` 和 `config.ini` 等用户配置会在首次运行时自动在外侧隔离生成，无需打包。
    *   `--name`: 设置生成的 EXE 应用程序名称为 `QuickKV`。

3.  **获取结果**:
    打包成功后，您可以在项目根目录下的 `dist/QuickKV` 目录（如果未生成单文件）中找到生成的 `QuickKV.exe` 可执行文件。您也可以加上 `--onefile` 参数使其打包为单文件版本。

---

## ⚠️ 重要声明与许可协议 (IMPORTANT DISCLAIMER & LICENSE)

**在下载、安装或以任何方式使用本软件 (QuickKV) 与代码前，请您务必仔细阅读并充分理解以下所有条款。本软件是基于 MIT 许可证 (MIT License) 发布的免费开源项目。一旦您开始使用本软件的任何部分（包括但不限于运行程序、查阅代码、修改或分发），即表示您已完全阅读、理解并无条件接受本声明及 MIT 许可证的全部内容。如果您不同意其中任何条款，请立即停止使用并彻底删除本软件的所有相关文件。**

**1. “按原样”提供，不作任何保证 (AS-IS, WITHOUT ANY WARRANTY)**
本软件按“原样”(AS IS) 提供，不附带任何形式的明示或暗示的保证，包括但不限于对软件的**商业适用性 (MERCHANTABILITY)**、**特定用途适用性 (FITNESS FOR A PARTICULAR PURPOSE)** 和 **非侵权性 (NON-INFRINGEMENT)** 的保证。作者不保证软件能满足您的所有需求，不保证软件运行不会中断或不出现任何错误，也不保证软件中的任何缺陷 (Bug) 都将被修正。所有条款以软件附带的 [MIT 许可证](https://github.com/msjsc001/QuickKV/blob/main/LICENSE) 原文为准。    

**2. 核心功能与潜在风险告知 (CORE FUNCTIONALITY & POTENTIAL RISKS)**
本软件的核心功能必然涉及**全局键盘监听** (用于实现快捷码、快捷键功能) 和**剪贴板内容读写** (用于粘贴及历史记忆功能)。您必须清楚地认识到这些功能存在的潜在风险：
*   **键盘监听风险**: 为了实现快捷码功能，程序会在后台监听您的键盘输入。尽管程序的设计初衷仅为匹配您设定的触发码，但该机制在技术原理上可以访问到您的全局键盘输入。
*   **剪贴板隐私风险**: 当“剪贴板记忆”功能开启时，程序会读取并以明文形式记录您复制到系统剪贴板的文本内容。这意味着，**如果您复制了密码、银行卡号、身份证、私密对话等任何敏感信息，这些信息也可能被程序记录下来。**
*   **安全软件警告**: 由于上述功能的敏感性，部分安全软件、杀毒软件或系统防护工具可能会将本软件标记为“键盘记录器”、“风险软件”或“恶意程序”。这属于正常现象，请您基于对本项目开源代码的信任自行判断并选择是否“信任”或“允许运行”。

**3. 风险自负与责任限制 (ASSUMPTION OF RISK & LIMITATION OF LIABILITY)**
您明确理解并同意，使用本软件所引发的一切后果和风险，包括但不限于**数据丢失或损坏、利润损失、业务中断、个人信息泄露、与其他软件的冲突、系统不稳定或崩溃等**，完全由您本人承担。在任何法律允许的最大范围内，本软件作者或任何贡献者在任何情况下均不对任何因使用、无法使用或滥用本软件而导致的任何直接、间接、偶然、特殊、惩戒性或后果性的损害负责，即使已被告知可能发生此类损害。

**4. 用户数据与隐私保护 (USER DATA & PRIVACY)**
作者高度重视用户隐私。本软件为**纯本地离线工具**，您使用软件产生的所有数据，包括**词库文件 (`.md`)、配置文件 (`config.ini`)、剪贴板历史记录等，均只会存储在您自己的电脑本地硬盘上**。本软件不会以任何形式主动收集、存储或上传您的任何个人信息或使用数据到任何网络服务器。软件运行无需联网。

**5. 合法合规使用承诺 (LAWFUL & COMPLIANT USE)**
您承诺将在遵守您所在国家或地区所有适用法律法规的前提下使用本软件。严禁将本软件用于任何非法目的，包括但不限于窃取商业秘密、侵犯他人隐私、发送垃圾信息等任何违法违规行为。任何因您的非法使用或违规操作而导致的法律责任和后果，均由您自行承担，与本软件作者无关。此外，如果您在组织或公司环境（如工作电脑）中使用本软件，您有责任确保此行为符合该组织的信息安全策略和规定。

**6. 开源透明与代码审查 (OPEN SOURCE & CODE AUDIT)**
本软件是一个开源项目，所有源代码均在 GitHub 公开。我们鼓励并建议有能力的用户在安装使用前，**自行审查代码**，以确保其安全性和功能符合您的预期。作者保证其发布的官方版本不包含任何已知的恶意代码，但无法保证软件绝对没有缺陷。

**7. 官方渠道与安全下载 (OFFICIAL CHANNEL & SECURE DOWNLOAD)**
本项目的唯一官方发布渠道为 GitHub Releases 页面 (`https://github.com/msjsc001/QuickKV/releases`)。作者不对任何从第三方网站、论坛、社群、个人分享等非官方渠道获取的软件副本的安全性、完整性或一致性作任何保证。为避免潜在的恶意代码注入或版本篡改风险，请务必通过官方渠道下载。

**8. 无专业支持义务 (NO OBLIGATION FOR SUPPORT)**
本软件为免费提供，作者没有义务提供任何形式的商业级技术支持、更新、用户培训或后续服务。作者可能会通过 GitHub Issues 等社区渠道提供帮助，但这完全出于自愿且不作任何承诺，作者保留随时忽略或关闭任何问题的权利。

**再次强调：继续使用本软件，即表示您已确认阅读、理解并同意遵守上述所有条款以及 MIT 许可证的全部内容。**




